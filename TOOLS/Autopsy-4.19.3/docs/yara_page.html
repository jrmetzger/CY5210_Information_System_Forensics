<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: YARA Analyzer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Autopsy User Documentation
   &#160;<span id="projectnumber">4.19.2</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Autopsy User&#39;s Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">YARA Analyzer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#yara_overview">Overview</a></li>
<li class="level1"><a href="#yara_config">Configuration</a></li>
<li class="level1"><a href="#yara_running">Running the Module</a></li>
<li class="level1"><a href="#yara_results">Viewing Results</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="yara_overview"></a>
Overview</h1>
<p>The YARA Analyzer module uses a set of rules to search files for textual or binary patterns. YARA was designed for malware analysis but can be used to search for any type of files. For more information on YARA see <a href="https://virustotal.github.io/yara/">https://virustotal.github.io/yara/</a>.</p>
<h1><a class="anchor" id="yara_config"></a>
Configuration</h1>
<p>To create and edit your rule sets, go to "Tools", "Options" and then select the "YARA" tab.</p>
<div class="image">
<img src="yara_options.png" alt="yara_options.png"/>
</div>
<p>YARA rule sets are stored in folders in the user's Autopsy folder. To create a new rule set, click the "New Set" button in the lower left and enter the name for your new set.</p>
<div class="image">
<img src="yara_new_rule_set.png" alt="yara_new_rule_set.png"/>
</div>
<p>With your new rule set selected, click the "Open Folder" button to go to the newly created rules folder. You can now copy existing YARA files into this folder to include them in the rule set. Information on writing YARA rules can be found <a href="https://yara.readthedocs.io/en/stable/writingrules.html">here</a> and many existing YARA rules can be found through a web search. As a very simple example, we will add this rule to the sample rule set to find files that contain the words "hello" and "world":</p>
<pre class="fragment">rule HelloWorldRule
{
    strings:
        $part1 = "hello" nocase 
        $part2 = "world" nocase 

    condition:
        $part1 and $part2
}
</pre><p>Once you've added your rules to the folder, click the "Refresh File List" button to show them in the options panel.</p>
<h1><a class="anchor" id="yara_running"></a>
Running the Module</h1>
<p>To enable the YARA Analyzer ingest module select the checkbox in the <a class="el" href="ingest_page.html#ingest_configure">Ingest Modules configuration screen</a>.</p>
<div class="image">
<img src="yara_ingest_settings.png" alt="yara_ingest_settings.png"/>
</div>
<p>Make sure all rule sets you want to run are checked. You can also choose between running on all files or only running on executable files.</p>
<h1><a class="anchor" id="yara_results"></a>
Viewing Results</h1>
<p>Results are show in the Results tree under "Extracted Content".</p>
<div class="image">
<img src="yara_results.png" alt="yara_results.png"/>
</div>
 </div></div><!-- contents -->
<hr/>
<p><i>Copyright &#169; 2012-2021 Basis Technology. Generated on Fri Dec 17 2021<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
